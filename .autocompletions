# Activate autocomplete for zsh
autoload -U compinit && compinit

# Kubectl autocomplete
source <(kubectl completion zsh)
complete -F __start_kubectl kc

# Helm autocomplete
source <(helm completion zsh)

# Rclone autocomplete
#source <(rclone completion zsh)

# Argocd autocomplete
compdef _argocd argocd
source <(argocd completion zsh)

# Stern autocomplete 
# Haven't gotten this to work yet
#compdef _stern stern
#source <(stern --completion=zsh)

# Kgsec autocomplete function
_kgsec() {
  # Get list of secret names using kubectl
  local secrets=$(kubectl get secrets -o jsonpath='{range .items[*]}{.metadata.name}{"\n"}{end}')

  # Parse secret names and set completions
  local completions=("${(@f)secrets}")
  _arguments '*:secret name:_values -s "," "${completions[@]}"'
}

# Register completion function for kgsec
compdef _kgsec kgsec
